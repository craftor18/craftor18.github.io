<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é€‰æ‹©æ¸…é™¤åˆ†æè¿è¡Œå®æ“ - craftor18çš„ä¸ªäººåšå®¢</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="craftor18" /><meta name="description" content="ä»ç¾¤ä½“é—ä¼ å­¦çš„å„ä¸ªæ¦‚å¿µï¼Œåˆ°ç¾¤ä½“é—ä¼ å­¦ç»“æ„åˆ†æçš„å„ä¸ªæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å€¼çš„è®¡ç®—åŸºæœ¬éƒ½æ˜¯åŸºäºvcfæ–‡ä»¶ï¼Œå› æ­¤é‡æµ‹åºåˆ†æçš„å­¦ä¹ ä¹Ÿå¾ˆé‡è¦ï¼Œä¸è¿‡æ—¢ç„¶" /><meta name="keywords" content="hugo, learn, blog" />






<meta name="generator" content="Hugo 0.110.0 with theme even" />


<link rel="canonical" href="https://craftor18.top/post/record_of_population_analysis_5/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<link href="/sass/main.min.69eef940cfa40c98e4c004e9b1104788fd2ff666acae33e49e5adba3e8dacb75.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é€‰æ‹©æ¸…é™¤åˆ†æè¿è¡Œå®æ“" />
<meta property="og:description" content="ä»ç¾¤ä½“é—ä¼ å­¦çš„å„ä¸ªæ¦‚å¿µï¼Œåˆ°ç¾¤ä½“é—ä¼ å­¦ç»“æ„åˆ†æçš„å„ä¸ªæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å€¼çš„è®¡ç®—åŸºæœ¬éƒ½æ˜¯åŸºäºvcfæ–‡ä»¶ï¼Œå› æ­¤é‡æµ‹åºåˆ†æçš„å­¦ä¹ ä¹Ÿå¾ˆé‡è¦ï¼Œä¸è¿‡æ—¢ç„¶" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://craftor18.top/post/record_of_population_analysis_5/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-02-14T14:37:53+08:00" />
<meta property="article:modified_time" content="2023-02-14T14:37:53+08:00" />
<meta itemprop="name" content="ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é€‰æ‹©æ¸…é™¤åˆ†æè¿è¡Œå®æ“">
<meta itemprop="description" content="ä»ç¾¤ä½“é—ä¼ å­¦çš„å„ä¸ªæ¦‚å¿µï¼Œåˆ°ç¾¤ä½“é—ä¼ å­¦ç»“æ„åˆ†æçš„å„ä¸ªæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å€¼çš„è®¡ç®—åŸºæœ¬éƒ½æ˜¯åŸºäºvcfæ–‡ä»¶ï¼Œå› æ­¤é‡æµ‹åºåˆ†æçš„å­¦ä¹ ä¹Ÿå¾ˆé‡è¦ï¼Œä¸è¿‡æ—¢ç„¶"><meta itemprop="datePublished" content="2023-02-14T14:37:53+08:00" />
<meta itemprop="dateModified" content="2023-02-14T14:37:53+08:00" />
<meta itemprop="wordCount" content="1645">
<meta itemprop="keywords" content="ç¾¤ä½“é—ä¼ å­¦,ç”Ÿç‰©ä¿¡æ¯å­¦," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é€‰æ‹©æ¸…é™¤åˆ†æè¿è¡Œå®æ“"/>
<meta name="twitter:description" content="ä»ç¾¤ä½“é—ä¼ å­¦çš„å„ä¸ªæ¦‚å¿µï¼Œåˆ°ç¾¤ä½“é—ä¼ å­¦ç»“æ„åˆ†æçš„å„ä¸ªæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å€¼çš„è®¡ç®—åŸºæœ¬éƒ½æ˜¯åŸºäºvcfæ–‡ä»¶ï¼Œå› æ­¤é‡æµ‹åºåˆ†æçš„å­¦ä¹ ä¹Ÿå¾ˆé‡è¦ï¼Œä¸è¿‡æ—¢ç„¶"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1024549225701007"
     crossorigin="anonymous"></script>

  <link rel="stylesheet" type="text/css" href="/css/style.css">
</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Craftor18</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">ä¸»é¡µ</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">å½’æ¡£</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">æ ‡ç­¾</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">åˆ†ç±»</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Craftor18</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">ä¸»é¡µ</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">å½’æ¡£</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">æ ‡ç­¾</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">åˆ†ç±»</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦å­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰é€‰æ‹©æ¸…é™¤åˆ†æè¿è¡Œå®æ“</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-02-14 </span>
        <div class="post-category">
            <a href="/categories/%E5%AD%A6%E4%B9%A0/"> å­¦ä¹  </a>
            </div>
          <span class="more-meta"> çº¦ 1645 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 4 åˆ†é’Ÿ </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> æ¬¡é˜…è¯» </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#fstpiå€¼çš„è®¡ç®—">Fstã€piå€¼çš„è®¡ç®—</a></li>
            <li><a href="#rodå€¼çš„è®¡ç®—åŠç»˜å›¾">RODå€¼çš„è®¡ç®—åŠç»˜å›¾</a></li>
            <li><a href="#é€‰æ‹©æ¶ˆé™¤åˆ†æ">é€‰æ‹©æ¶ˆé™¤åˆ†æ</a></li>
            <li><a href="#ä»Šæ—¥ã®æ€»ç»“">ä»Šæ—¥ã®æ€»ç»“</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>ä»ç¾¤ä½“é—ä¼ å­¦çš„å„ä¸ªæ¦‚å¿µï¼Œåˆ°ç¾¤ä½“é—ä¼ å­¦ç»“æ„åˆ†æçš„å„ä¸ªæ­¥éª¤ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™äº›å€¼çš„è®¡ç®—åŸºæœ¬éƒ½æ˜¯åŸºäºvcfæ–‡ä»¶ï¼Œå› æ­¤é‡æµ‹åºåˆ†æçš„å­¦ä¹ ä¹Ÿå¾ˆé‡è¦ï¼Œä¸è¿‡æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†vcfæ–‡ä»¶ï¼Œé‚£ä¹ˆæœ¬ç¯‡å®æ“ä¸€ä¸‹<strong>é€‰æ‹©æ¸…é™¤åˆ†æ</strong>çš„æµç¨‹ï¼Œå½“ç„¶ï¼Œè¿˜æ˜¯ç”¨åŸºå› ç»„å­¦å¤§è®²å ‚çš„æµç¨‹ï¼Œä½†æ˜¯æˆ‘åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¹Ÿå‘ç°äº†ä¸€äº›è„šæœ¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹æ‰èƒ½æ­£ç¡®æ˜¾ç¤ºå‡ºå›¾ã€‚</p>
<p>æ•°æ®ç›®å‰çš„ç›®å½•ç»“æ„:æˆ‘æ‰€æœ‰çš„è„šæœ¬å’Œå‘½ä»¤éƒ½æ‹·åˆ°äº†linuxçš„docker é‡Œé¢ï¼Œå› æ­¤å·¥ä½œè·¯å¾„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ï¼Œå¦‚ä½•å®‰è£…dockerå’Œé•œåƒçš„æ•™ç¨‹å¯ä»¥è‡ªå·±ä¸Šç½‘æŸ¥æŸ¥ã€‚ç»„å­¦å¤§è®²å ‚é‡Œå¥½åƒä¹Ÿæœ‰ã€‚</p>
<p><code> docker pull omicsclass/pop-evol-gwas:latest #ä¸‹è½½é•œåƒ</code></p>
<p><code> docker run --rm -it -m 4G --cpus 1 -v /share/work/huangls/pop_evo:/work omicsclass/pop-evol-gwas:latest</code></p>
<p><img src="/img/dirstr.png" alt="dirstr"></p>
<h3 id="fstpiå€¼çš„è®¡ç®—">Fstã€piå€¼çš„è®¡ç®—</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">######################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#é€‰æ‹©æ¶ˆé™¤åˆ†æ  fst pi ROD  åŸºäºå¤šæ ·æ€§é™ä½</span>
</span></span><span class="line"><span class="cl"><span class="c1">########################################################</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> <span class="nv">$workdir</span>  <span class="c1">#å›åˆ°å·¥ä½œç›®å½•</span>
</span></span><span class="line"><span class="cl">mkdir 05.select_sweep
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> 05.select_sweep
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ä¸åŒç¾¤ä½“çš„æ ·æœ¬åˆ†å¼€æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­</span>
</span></span><span class="line"><span class="cl">cat <span class="nv">$GROUP</span> <span class="p">|</span>grep wild <span class="p">|</span>cut -f <span class="m">1</span> &gt;wild_popid.txt
</span></span><span class="line"><span class="cl">cat <span class="nv">$GROUP</span> <span class="p">|</span>grep cultivated<span class="p">|</span>grep -v <span class="s2">&#34;Indian&#34;</span><span class="p">|</span>grep -v <span class="s2">&#34;Xishuangbanna&#34;</span> <span class="p">|</span>cut -f <span class="m">1</span> &gt;cultivated_popid.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#fst  pi  tajimaDåˆ†æ</span>
</span></span><span class="line"><span class="cl">mkdir fst_pi_ROD
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> fst_pi_ROD
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®è¾“å…¥çš„vcfæ–‡ä»¶ä¸è®¡ç®—çš„çª—å£å’Œæ­¥é•¿</span>
</span></span><span class="line"><span class="cl"><span class="nv">gzvcf</span><span class="o">=</span><span class="nv">$workdir</span>/00.filter/clean.vcf.gz
</span></span><span class="line"><span class="cl"><span class="nv">window</span><span class="o">=</span><span class="m">100000</span>
</span></span><span class="line"><span class="cl"><span class="nv">step</span><span class="o">=</span><span class="m">10000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#pi å¤šæ ·æ€§</span>
</span></span><span class="line"><span class="cl">vcftools  --gzvcf <span class="nv">$gzvcf</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --window-pi <span class="nv">$window</span> --window-pi-step  <span class="nv">$step</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --keep ../wild_popid.txt   --out pi.wild
</span></span><span class="line"><span class="cl">vcftools  --gzvcf <span class="nv">$gzvcf</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --window-pi <span class="nv">$window</span> --window-pi-step  <span class="nv">$step</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --keep ../cultivated_popid.txt  --out pi.cultivated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#piå¤šæ ·æ€§ç»˜å›¾è¾“å‡º</span>
</span></span><span class="line"><span class="cl">pi_manhattan_plot.r -i pi.wild.windowed.pi -F <span class="nv">$FAI</span> -f <span class="m">19226500</span> -n pi.wild
</span></span><span class="line"><span class="cl">pi_smooth_line_plot.r -i pi.wild.windowed.pi -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n pi.wild.smoothline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Fst  ç¾¤ä½“é—´å¤šæ ·æ€§å·®å¼‚</span>
</span></span><span class="line"><span class="cl">vcftools  --gzvcf <span class="nv">$gzvcf</span> --fst-window-size <span class="nv">$window</span> --fst-window-step <span class="nv">$step</span>  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --weir-fst-pop  ../wild_popid.txt --weir-fst-pop ../cultivated_popid.txt --out  Fst.wild.cultivated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#fstç»˜å›¾è¾“å‡º</span>
</span></span><span class="line"><span class="cl">fst_manhattan_plot.r -i Fst.wild.cultivated.windowed.weir.fst -F <span class="nv">$FAI</span> -f <span class="m">19226500</span> -n Fst.wild.cultivated
</span></span><span class="line"><span class="cl">fst_manhattan_plot.r -i Fst.wild.cultivated.windowed.weir.fst -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n Fst.wild.cultivated_vline --vline
</span></span><span class="line"><span class="cl">fst_smooth_line_plot.r -i Fst.wild.cultivated.windowed.weir.fst -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n Fst.wild.cultivated_smoothline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#fst ä¸ pi è”åˆ ç­›é€‰å—é€‰æ‹©åŒºåŸŸ</span>
</span></span><span class="line"><span class="cl">Rscript <span class="nv">$scriptdir</span>/fst_pi_select_sweep.r --fst Fst.wild.cultivated.windowed.weir.fst <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --pi1 pi.wild.windowed.pi --pi2 pi.cultivated.windowed.pi --zscore --log2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -A wild -B cultivated -c 0.05 -n fst-pi.wild-vs-cultivated  -f pdf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Rscript <span class="nv">$scriptdir</span>/fst_pi_select_sweep.r --fst Fst.wild.cultivated.windowed.weir.fst <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    --pi1 pi.wild.windowed.pi --pi2 pi.cultivated.windowed.pi --zscore --log2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -A wild -B cultivated -c 0.05 -n fst-pi.wild-vs-cultivated  -f png
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="rodå€¼çš„è®¡ç®—åŠç»˜å›¾">RODå€¼çš„è®¡ç®—åŠç»˜å›¾</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#RODè®¡ç®—ä¸å±•ç¤º</span>
</span></span><span class="line"><span class="cl">rod_calculate.r --wild pi.wild.windowed.pi --domesticated pi.cultivated.windowed.pi -p ROD.wild.cultivated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ç»˜å›¾è¾“å‡º</span>
</span></span><span class="line"><span class="cl">rod_manhattan_plot.r -i ROD.wild.cultivated.txt -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n ROD.wild.cultivated 
</span></span><span class="line"><span class="cl">rod_smooth_line_plot.r -i ROD.wild.cultivated.txt -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n ROD.wild.cultivated.smoothline
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é€‰æ‹©æ¶ˆé™¤åˆ†æ">é€‰æ‹©æ¶ˆé™¤åˆ†æ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1">#################################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#é€‰æ‹©æ¶ˆé™¤åˆ†æ   XP-CLR  tajima&#39;D åˆ†æ  åŸºäºé¢‘ç‡å·®å¼‚  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#################################################</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span>  <span class="nv">$workdir</span>/05.select_sweep
</span></span><span class="line"><span class="cl">mkdir xpclr
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> xpclr
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## xpclrè½¯ä»¶æ¯æ¬¡åªèƒ½è¿è¡Œ1ä¸ªæŸ“è‰²ä½“</span>
</span></span><span class="line"><span class="cl"><span class="c1">## åŸå§‹çš„XPCLRåˆ†æï¼šhttps://www.omicsclass.com/article/1334</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#python ç‰ˆæœ¬çš„xpclr,ç»“æœè¯´æ˜è§ï¼š  https://github.com/hardingnj/xpclr</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ä¸åŒçš„æŸ“è‰²ä½“åˆ†åˆ«è®¡ç®—</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in Chr1 Chr2 Chr3 Chr4 Chr5 Chr6 Chr7<span class="p">;</span><span class="k">do</span> <span class="o">(</span>xpclr --format vcf --input <span class="nv">$workdir</span>/00.filter/clean.vcf.gz --samplesA ../wild_popid.txt --samplesB ../cultivated_popid.txt --out ./<span class="nv">$i</span>.xpclr --chr <span class="nv">$i</span> --size <span class="nv">$window</span>  --step <span class="nv">$step</span> --maxsnps <span class="m">200</span> --minsnps <span class="m">5</span> <span class="p">&amp;</span><span class="o">)</span><span class="p">;</span><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1">#python ç‰ˆæœ¬çš„xpclrå‚æ•°ä½¿ç”¨è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--format æŒ‡å®šè¾“å…¥æ–‡ä»¶æ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--input æŒ‡å®šè¾“å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--samplesA or B æŒ‡å®šå‚ä¸åˆ†æçš„ä¸ªä½“</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--chr æŒ‡æ˜è¿è¡Œçš„æŸ“è‰²ä½“</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--phased æŒ‡æ˜vcfæ–‡ä»¶æ˜¯phasedåçš„ï¼ˆå¦‚æœæ²¡æœ‰phasedå°±å»æ‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--ld æŒ‡å®šç”¨äºåŠ æƒçš„è¿é”ä¸è¡¡é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--maxsnp çª—å£å†…å‚ä¸è®¡ç®—çš„SNPæ•°é‡</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--size æŒ‡å®šæ»‘çª—çš„å¤§å°ï¼ˆç‰©ç†è·ç¦»ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--step æŒ‡å®šæ­¥é•¿</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--out æŒ‡å®šè¾“å‡ºæ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl"><span class="c1">#--rrate æŒ‡å®šæ¯bpçš„é‡ç»„ç‡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#awkåˆå¹¶æ–‡ä»¶ ä¿ç•™ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„è¡¨å¤´</span>
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;FNR==1 &amp;&amp; NR!=1{next;}{print}&#39;</span> *.xpclr &gt;all.chr.xpclr
</span></span><span class="line"><span class="cl">xpclr_manhattan_plot.r -i all.chr.xpclr -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n all.chr.xpclr --vline
</span></span><span class="line"><span class="cl">xpclr_smooth_line_plot.r -i all.chr.xpclr -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n all.chr.xpclr.smoothline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span>  <span class="nv">$workdir</span>/05.select_sweep
</span></span><span class="line"><span class="cl">mkdir TajimaD
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> TajimaD
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Tajima&#39;s D </span>
</span></span><span class="line"><span class="cl"><span class="c1">#vcftoolsæ— æ³•ç”¨æ»‘åŠ¨çª—å£</span>
</span></span><span class="line"><span class="cl">vcftools --gzvcf <span class="nv">$gzvcf</span> --TajimaD  <span class="m">100000</span>  --keep  ../wild_popid.txt  --out wild
</span></span><span class="line"><span class="cl">vcftools --gzvcf <span class="nv">$gzvcf</span> --TajimaD  <span class="m">100000</span>  --keep  ../cultivated_popid.txt  --out cultivated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tajimaD_manhattan_plot.r -i cultivated.Tajima.D -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n TajimaD.cultivated 
</span></span><span class="line"><span class="cl">tajimaD_smooth_line_plot.r -i cultivated.Tajima.D -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n TajimaD.cultivated.smoothline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tajimaD_manhattan_plot.r -i wild.Tajima.D -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n TajimaD.wild 
</span></span><span class="line"><span class="cl">tajimaD_smooth_line_plot.r -i wild.Tajima.D -F <span class="nv">$FAI</span> -f <span class="m">19226500</span>  -n TajimaD.wild.smoothline
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">####################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#xpehh  https://www.mdpi.com/2076-2615/11/1/157/htm</span>
</span></span><span class="line"><span class="cl"><span class="c1">#########################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#éœ€è¦é—ä¼ å›¾æˆ–è€…phase</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">###############################################</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ç­›é€‰å€™é€‰åŒºåŸŸåŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="c1">##################################################</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span>  <span class="nv">$workdir</span>/05.select_sweep
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ä»¥Fst top 5%çš„åŒºåŸŸä½œä¸ºå€™é€‰åŒºåŸŸï¼Œç­›é€‰åŒºåŸŸé‡Œé¢çš„åŸºå› ä¸ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="c1">#åˆå¹¶åŒºåŸŸ</span>
</span></span><span class="line"><span class="cl">bedtools merge -i fst_pi_ROD/Fst.wild.cultivated_selected_region_top0.05.txt &gt;fst_top0.5_selected_region.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#gffä¸­è·å–åŸºå› ä½ç½®</span>
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;$3==&#34;gene&#34;&#39;</span> <span class="nv">$GFF</span> &gt; gene.gff
</span></span><span class="line"><span class="cl"><span class="c1">#ç­›é€‰å—é€‰æ‹©åŒºåŸŸå†…åŸºå› </span>
</span></span><span class="line"><span class="cl">bedtools  intersect -wo -F 0.1 -nonamecheck -a  fst_top0.5_selected_region.txt -b gene.gff <span class="p">|</span> sort -u  &gt; Fst.top0.05.gene.txt
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä»Šæ—¥ã®æ€»ç»“">ä»Šæ—¥ã®æ€»ç»“</h3>
<p>ä¸»è¦å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨vcftoolsæ ¹æ®vcfæ–‡ä»¶ä¸­infoå’Œæ ·æœ¬haplotypeé‡Œæœ‰å…³åŸºå› é¢‘ç‡å‚æ•°æ¥è®¡ç®—fstå’Œpiä»¥åŠRODç­‰å„é¡¹ä¸ç¾¤ä½“é—ä¼ è¿›åŒ–å­¦ä¸Šé‡è¦å€¼ï¼Œè®¡ç®—è¿‡ç¨‹åˆ™æ— éœ€æˆ‘ä»¬æ‹…å¿ƒï¼Œå› ä¸ºvcftoolsä¼šè‡ªåŠ¨è¯†åˆ«ï¼Œä½†æ˜¯æœ‰å…³ç»“æœçš„ç»“æ„å’Œè½¬æ¢æ˜¯æˆ‘ä»¬éœ€è¦çŸ¥é“çš„ï¼Œå› ä¸ºè¿™èƒ½å¸®åŠ©æˆ‘ä»¬æœ‰æ•ˆç­›é€‰ç¬¦åˆæ¡ä»¶çš„SNPå’Œç»˜å›¾æ—¶è®¾ç½®ä¸€äº›å‚æ•°ä»è€Œé¿å…ç»˜å›¾ç»“æœä¸å¥½çœ‹æˆ–è€…ç­›é€‰å‡ºä¸€äº›å‡é˜³æ€§çš„ç»“æœã€‚æ€»çš„æ¥è¯´ï¼Œç­‰ä½åŸºå› é¢‘ç‡ä¸ä¸­æ€§è¿›åŒ–å‡è¯´æ˜¯æˆ‘ä»¬è®¡ç®—è¿™ä¸‰ä¸ªæ•°å€¼æ—¶éœ€è¦è€ƒè™‘åˆ°çš„ï¼Œæ ¹æ®è¿™äº›æ¥è®¾ç½®æœ‰å…³æ»‘åŠ¨çª—å£ä»¥åŠstepsä»è€Œå¾—åˆ°åˆç†çš„è®¡ç®—ç»“æœï¼Œé¿å…é”™è¿‡ä¸€äº›é‡è¦SNPä½ç‚¹ã€‚åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æˆ‘ä¸»è¦å‚è€ƒå…¶åˆ©ç”¨bedtoolsæå–å¯¹åº”åŸºå› ä½ç½®çš„è¿‡ç¨‹ï¼Œä»¥æ­¤æ¥ç¼–å†™è‡ªå·±æå–SNPä½ç½®çš„è¿‡ç¨‹ï¼Œå› ä¸ºSNPä½ç½®çš„æå–ä¼¼ä¹åªéœ€è¦ä»¥æ¥vcfæ–‡ä»¶å³å¯ï¼Œæ— éœ€å‚è€ƒåŸºå› ç»„æ³¨é‡Šæ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦æ˜¯snpeffæ³¨é‡Šè¿‡å¾—vcfæ–‡ä»¶ã€‚</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">craftor18</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        2023-02-14
        
    </span>
  </p>
  
  
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">èµèµæ”¯æŒ</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechat.png">
        <span>å¾®ä¿¡æ‰“èµ</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay.png">
        <span>æ”¯ä»˜å®æ‰“èµ</span>
      </label>
  </div>
</div><footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6/">ç¾¤ä½“é—ä¼ å­¦</a>
          <a href="/tags/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/">ç”Ÿç‰©ä¿¡æ¯å­¦</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/record_of_population_analysis_4/">
            <span class="next-text nav-default">ç¾¤ä½“é—ä¼ å­¦å­¦ä¹ ç¬”è®°ï¼ˆå››ï¼‰ å…³äºç¾¤ä½“ç»“æ„STRCTUREçš„ä¸€äº›åˆ†æå®æ“è®°å½•</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="craftor18/craftor18.github.io"
            issue-term="url"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:1369429823@qq.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/craftor18" class="iconfont icon-github" title="github"></a>
      <a href="https://space.bilibili.com/25805086?spm_id_from=333.1007.0.0" class="iconfont icon-bilibili" title="bilibili"></a>

</div>

<div class="copyright">
  <span class="power-by">
    åŸºäº <a class="hexo-link" href="https://gohugo.io">Hugo</a> åšå®¢æ¶æ„ 
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> æ¬¡ </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> æœ¬ç«™æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> äºº </span>
  </div>


  <footer>
    <span>Copyright Â© 2023 </span>
    <a href="https://www.cnblogs.com/zengy-bioinfostudy/">
      <span>ğŸ’–Craftor18</span>
    </a>
  </footer>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js"></script>








</body>
</html>
